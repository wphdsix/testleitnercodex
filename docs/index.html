<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système Leitner - Gestion de Flashcards</title>
    <link rel="stylesheet" href="style.css">
        <!-- Icône du site (favicon) -->
    <link rel="icon" type="image/png" href="mordor-2340048_1280.png">
    <!-- Variante avec un .ico classique -->
    <!-- <link rel="icon" href="favicon.ico" type="image/x-icon"> -->
</head>
<body class="site-background text-gray-800">
    <div class="container mx-auto max-w-6xl p-5">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Démonstration du système de Leitner</h1>
            <p class="text-gray-600">Apprentissage par répétition espacée</p>
            <p class="text-gray-600">Par OM en 2025.09.03</p>            
        </header>

        <div class="tab-container">
            <nav class="tab-nav" role="tablist" aria-label="Navigation principale">
                <button id="tab-review-trigger" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-review" data-tab-target="review">
                    Révision
                </button>
                <button id="tab-packs-trigger" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-packs" data-tab-target="packs">
                    Mes Paquets
                </button>
                <button id="tab-stats-trigger" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-stats" data-tab-target="stats">
                    Statistiques
                </button>
                <button id="tab-import-trigger" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-import" data-tab-target="import">
                    Import/Export
                </button>
            </nav>

            <section id="tab-review" class="tab-panel space-y-6" role="tabpanel" aria-labelledby="tab-review-trigger" data-tab-panel="review">
                <!-- Section gestion des fichiers -->
                <div class="bg-white rounded-lg shadow-md p-5">
                    <div class="flex flex-wrap justify-between items-center mb-4">
                        <h2 class="text-xl font-bold mb-4 md:mb-0 w-full md:w-auto">Gestion des fichiers CSV</h2>
                        <div class="flex flex-wrap gap-2 w-full md:w-auto">
                            <button id="add-card-btn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex-1 md:flex-none">
                                + Nouvelle carte
                            </button>
                            <button id="download-csv" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex-1 md:flex-none">
                                Télécharger CSV
                            </button>
                            <button id="import-csv" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 flex-1 md:flex-none">
                                Importer CSV
                            </button>
                            <input type="file" id="csv-file" class="hidden" accept=".csv">
                        </div>
                    </div>

                    <div class="mb-4 flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                        <select id="csv-selector" class="p-2 border rounded w-full md:min-w-[250px] md:max-w-[350px]">
                            <option value="default">Chargement des fichiers...</option>
                        </select>
                        <div class="flex gap-2 w-full md:w-auto">
                            <button id="load-csv" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 flex-1 md:flex-none whitespace-nowrap">
                                Charger
                            </button>
                            <button id="create-csv" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 flex-1 md:flex-none whitespace-nowrap">
                                Nouveau CSV
                            </button>
                        </div>
                    </div>

                    <div id="new-csv-form" class="hidden mt-4 p-4 bg-gray-100 rounded">
                        <div class="flex flex-col md:flex-row md:items-center gap-2">
                            <input type="text" id="new-csv-name" placeholder="Nom du fichier (sans .csv)" class="p-2 border rounded flex-1 md:max-w-[300px]">
                            <button id="save-new-csv" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 mt-2 md:mt-0">
                                Créer
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Boîtes Leitner -->
                <div id="leitner-boxes" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <!-- Les boîtes seront générées dynamiquement -->
                </div>

                <!-- Liste des cartes -->
                <div id="cards-list-container" class="hidden bg-white rounded-lg shadow-md p-5">
                    <div class="flex justify-between items-center mb-4">
                        <h3 id="cards-list-title" class="text-xl font-bold">Cartes de la boîte <span id="current-box-number">1</span></h3>
                        <button id="close-cards-list" class="text-gray-500 hover:text-gray-700">
                            ✕
                        </button>
                    </div>
                    <div id="cards-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
                </div>

                <!-- Éditeur de carte -->
                <div id="card-editor" class="hidden fixed inset-0 flex items-center justify-center p-5 z-50 bg-black bg-opacity-50" role="dialog" aria-modal="true" aria-labelledby="editor-title" aria-hidden="true">
                    <div class="bg-white rounded-xl shadow-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" tabindex="-1">
                        <h3 class="text-xl font-bold mb-4" id="editor-title">Nouvelle carte</h3>
                        <form id="card-form" class="space-y-4">
                            <input type="hidden" id="card-id">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                                <textarea id="card-question" class="w-full p-2 border rounded" rows="3" required></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1" for="card-question-image">Image question</label>
                                <div class="image-input-wrapper space-y-2">
                                    <div class="flex flex-col gap-2 md:flex-row md:items-start">
                                        <div class="flex flex-1 flex-wrap gap-2 md:flex-nowrap">
                                            <input type="text" id="card-question-image" class="flex-1 p-2 border rounded" placeholder="nom-du-fichier.jpg" aria-describedby="question-image-status">
                                            <input type="file" id="question-image-upload" class="hidden" accept="image/*">
                                            <button type="button" id="browse-question-image" class="bg-gray-200 px-3 rounded hover:bg-gray-300">Parcourir</button>
                                            <button type="button" id="clear-question-image" class="bg-red-100 text-red-600 px-3 rounded hover:bg-red-200">Retirer</button>
                                        </div>
                                        <div id="question-image-dropzone" class="image-dropzone" tabindex="0" role="button" aria-describedby="question-image-status">
                                            <span>Glissez-déposez, collez ou cliquez pour ajouter une image.</span>
                                        </div>
                                    </div>
                                    <p id="question-image-status" class="image-status">Aucune image sélectionnée.</p>
                                    <img id="question-image-preview" class="image-preview" alt="Prévisualisation de l'image question" aria-hidden="true">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Réponse</label>
                                <textarea id="card-answer" class="w-full p-2 border rounded" rows="3" required></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1" for="card-answer-image">Image réponse</label>
                                <div class="image-input-wrapper space-y-2">
                                    <div class="flex flex-col gap-2 md:flex-row md:items-start">
                                        <div class="flex flex-1 flex-wrap gap-2 md:flex-nowrap">
                                            <input type="text" id="card-answer-image" class="flex-1 p-2 border rounded" placeholder="nom-du-fichier.jpg" aria-describedby="answer-image-status">
                                            <input type="file" id="answer-image-upload" class="hidden" accept="image/*">
                                            <button type="button" id="browse-answer-image" class="bg-gray-200 px-3 rounded hover:bg-gray-300">Parcourir</button>
                                            <button type="button" id="clear-answer-image" class="bg-red-100 text-red-600 px-3 rounded hover:bg-red-200">Retirer</button>
                                        </div>
                                        <div id="answer-image-dropzone" class="image-dropzone" tabindex="0" role="button" aria-describedby="answer-image-status">
                                            <span>Glissez-déposez, collez ou cliquez pour ajouter une image.</span>
                                        </div>
                                    </div>
                                    <p id="answer-image-status" class="image-status">Aucune image sélectionnée.</p>
                                    <img id="answer-image-preview" class="image-preview" alt="Prévisualisation de l'image réponse" aria-hidden="true">
                                </div>
                            </div>
                            <div class="flex justify-end gap-3 pt-4">
                                <button type="button" id="cancel-edit" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                                    Annuler
                                </button>
                                <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                    Sauvegarder
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Visualisateur de carte -->
                <div id="flashcard-container" class="hidden fixed inset-0 flex items-center justify-center p-5 z-50 bg-black bg-opacity-50" role="dialog" aria-modal="true" aria-labelledby="question-content" aria-hidden="true">
                    <div class="flashcard bg-white rounded-xl shadow-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" tabindex="-1">
                        <div class="question-section bg-gray-50 rounded-lg p-4 mb-5">
                            <h3 class="font-bold text-lg mb-3">Question</h3>
                            <div id="question-content" class="text-lg my-4"></div>
                            <div id="last-reviewed" class="text-sm text-gray-500 italic"></div>
                        </div>
                        <button id="show-answer-btn" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 mb-5">
                            Voir la réponse
                        </button>
                        <div id="answer-section" class="hidden bg-gray-100 rounded-lg p-4 mt-5">
                            <h3 class="font-bold text-lg mb-3">Réponse</h3>
                            <div id="answer-content" class="text-lg my-4"></div>
                            <div class="flex flex-wrap items-center gap-3 mt-2">
                                <label for="answer-difficulty" class="text-sm font-medium text-gray-600">
                                    Difficulté ressentie
                                </label>
                                <select id="answer-difficulty" class="flex-1 min-w-[120px] p-2 border rounded">
                                    <option value="easy">Facile</option>
                                    <option value="normal" selected>Normale</option>
                                    <option value="hard">Difficile</option>
                                </select>
                            </div>
                            <div class="flex flex-wrap gap-3 mt-6">
                                <button id="wrong-answer" class="flex-1 bg-red-500 text-white py-2 rounded-lg font-bold hover:bg-red-600">
                                    Faux
                                </button>
                                <button id="right-answer" class="flex-1 bg-green-500 text-white py-2 rounded-lg font-bold hover:bg-green-600">
                                    Vrai
                                </button>
                            </div>
                        </div>
                        <div class="mt-4 flex justify-between">
                            <button id="edit-card-btn" class="text-blue-600 hover:text-blue-800">
                                Modifier
                            </button>
                            <button id="delete-card-btn" class="text-red-600 hover:text-red-800">
                                Supprimer
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Bouton Admin -->
                <div class="admin-button" id="admin-button">
                    ⚙️
                </div>

                <!-- Panel Admin -->
                <div id="admin-panel" class="hidden fixed inset-0 flex items-center justify-center p-5 z-50 bg-black bg-opacity-50" role="dialog" aria-modal="true" aria-labelledby="admin-panel-title" aria-hidden="true" tabindex="-1">
                    <div class="bg-white rounded-xl shadow-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold" id="admin-panel-title">Paramètres Administrateur</h3>
                            <button id="close-admin" class="text-gray-500 hover:text-gray-700 text-xl">
                                ✕
                            </button>
                        </div>

                        <div class="space-y-6">
                            <!-- Configuration GitHub -->
                            <div class="github-config bg-gray-100 rounded-lg p-4">
                                <h4 class="font-bold text-lg mb-3">Configuration GitHub</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Propriétaire du dépôt</label>
                                        <input type="text" id="repo-owner" class="w-full p-2 border rounded" placeholder="votre-nom-utilisateur">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Nom du dépôt</label>
                                        <input type="text" id="repo-name" class="w-full p-2 border rounded" placeholder="nom-du-dépôt">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Chemin du dossier (optionnel)</label>
                                        <input type="text" id="repo-path" class="w-full p-2 border rounded" placeholder="docs/">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Token d'accès (optionnel)</label>
                                        <input type="password" id="github-token" class="w-full p-2 border rounded" placeholder="ghp_xxx">
                                        <p class="text-xs text-gray-500 mt-1">Nécessaire seulement pour les dépôts privés</p>
                                    </div>
                                </div>
                                <button id="load-github-csv" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                    Charger les fichiers depuis GitHub
                                </button>
                            </div>

                            <!-- Intervalles de révision -->
                            <div class="intervals-config bg-gray-100 rounded-lg p-4">
                                <h4 class="font-bold text-lg mb-3">Intervalles de révision (en heures)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Boîte 1</label>
                                        <input type="number" id="interval-1" class="interval-input p-2 border rounded" min="1" value="1">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Boîte 2</label>
                                        <input type="number" id="interval-2" class="interval-input p-2 border rounded" min="1" value="3">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Boîte 3</label>
                                        <input type="number" id="interval-3" class="interval-input p-2 border rounded" min="1" value="9">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Boîte 4</label>
                                        <input type="number" id="interval-4" class="interval-input p-2 border rounded" min="1" value="27">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Boîte 5</label>
                                        <input type="number" id="interval-5" class="interval-input p-2 border rounded" min="1" value="81">
                                    </div>
                                </div>
                                <div class="mt-4 flex justify-end">
                                    <button id="save-intervals" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                                        Sauvegarder les intervalles
                                    </button>
                                </div>
                            </div>

                            <div class="difficulty-config bg-gray-100 rounded-lg p-4">
                                <h4 class="font-bold text-lg mb-3">Difficultés</h4>
                                <p class="text-sm text-gray-600 mb-4">Ajustez la pondération appliquée aux intervalles selon la difficulté perçue.</p>
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Facile</label>
                                        <input type="number" step="0.1" min="0.1" id="difficulty-easy" class="w-full p-2 border rounded" value="0.8">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Normale</label>
                                        <input type="number" step="0.1" min="0.1" id="difficulty-normal" class="w-full p-2 border rounded" value="1">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Difficile</label>
                                        <input type="number" step="0.1" min="0.1" id="difficulty-hard" class="w-full p-2 border rounded" value="1.4">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Difficulté par défaut</label>
                                        <select id="default-difficulty" class="w-full p-2 border rounded">
                                            <option value="easy">Facile</option>
                                            <option value="normal" selected>Normale</option>
                                            <option value="hard">Difficile</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4 flex justify-end">
                                    <button id="save-difficulties" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">
                                        Sauvegarder les difficultés
                                    </button>
                                </div>
                            </div>

                            <!-- Actions administratives -->
                            <div class="admin-actions bg-gray-100 rounded-lg p-4">
                                <h4 class="font-bold text-lg mb-3">Actions</h4>
                                <div class="flex flex-wrap gap-2">
                                    <button id="reset-all" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
                                        Réinitialiser toutes les données
                                    </button>
                                    <button id="export-all" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                        Exporter toutes les données
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="tab-packs" class="tab-panel hidden" role="tabpanel" aria-labelledby="tab-packs-trigger" data-tab-panel="packs">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold mb-2">Mes paquets</h2>
                    <p class="text-gray-600">La gestion détaillée des collections sera introduite lors des phases suivantes. Vous pouvez déjà consulter vos cartes via l'onglet Révision.</p>
                </div>
            </section>

            <section id="tab-stats" class="tab-panel hidden" role="tabpanel" aria-labelledby="tab-stats-trigger" data-tab-panel="stats">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-bold mb-4">Tableau de bord des statistiques</h2>
                    <p class="text-gray-600 mb-6">Analysez vos sessions de révision, suivez votre progression et identifiez vos tendances d'apprentissage.</p>
                    <div data-component="statistics-dashboard" class="statistics-dashboard__container"></div>
                </div>
            </section>

            <section id="tab-import" class="tab-panel hidden" role="tabpanel" aria-labelledby="tab-import-trigger" data-tab-panel="import">
                <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
                    <h2 class="text-2xl font-bold">Import / Export avancé</h2>
                    <p class="text-gray-600">Utilisez l'éditeur inline pour réaliser des corrections rapides, préparer un import ou exporter vos modifications.</p>
                    <div id="csv-inline-editor" class="csv-inline-editor__wrapper" aria-live="polite"></div>
                </div>
            </section>
        </div>

    <!-- Chargement des modules JavaScript -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="src/main.js"></script>
</body>
</html>